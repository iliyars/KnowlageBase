
### Синхронные операции ввода-вывода (напрмер чтения файла с жесткого диска)

- Создается объект `FileStream`. Далее методом `Read` читаются данные из файла. Вызов метода `Read` сопровождается переходом потока от управляемого когда в машинный код /код пользовательского режима. 
- При этом вызывается функция Win32 `ReadFile` (1). Она выделяет память для небольшой структуры, называемой пакетом запросов ввода-вывода (I/O Request Packet, IRP) (2). Эта структура инициализируется дескриптором файла, смещением анутри файла, с которого начинается чтение байтов, предназначенных для передачи.
- Функция `ReadFile` обращается к ядру Windows, переводя поток из кода пользовательского режима в код в режиме ядра и передавая в ядро IRP-структуру (3).
- По дескриптору устройсва ядро узнает, какое устройство предназначено для конкретной операции ввода-вывода, после чего пакет запросов ставиться в IRP-очередь нужного драйвера устройства (4).
- Каждый драйвер устройства управляет собственной очередью запросов ввода-вывода от всех запущенных на машине процессов. 
- При появлении IRP-пакетов драйвер устройства передает содержащуюся в них информацию соответсвующему устройству, которое и выполняет операци. ввода-вывода (5).
- **! В процессе выполнения устройством операции ввода-вывода поток исполнения, передавший запрос простаивает, поэтому Windows переводит его в спящее состояние (6)**
- После завершения устойством операции ввода-вывода Windows пробуждает поток, ставит его в очередь процессора и позволяет ему вернуть из режима ядра сначала в пользовательский режим, а затем и в управляемый код (7,8,9).
- Метод `Read` объекта `FileStream` при этом возвращает значение типа `int`, содержащее количество прочитанных из файла байт.

